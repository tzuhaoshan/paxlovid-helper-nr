# Paxlovid 給藥異常處理工具

## 1. 功能說明

本工具用於處理 Paxlovid 給藥過程中可能發生的異常情況，包括：
- 漏服藥品（Nirmatrelvir 和/或 Ritonavir）
- 多服藥品
- 給藥時間異常

工具提供以下功能：
- 視覺化顯示理論應服用量與實際服用量
- 即時計算偏差量並提供處理建議
- 顯示療程進度
- 提供藥局補發建議
- 提供護理餘藥處理建議
- 顯示剩餘療程安排

## 2. 判斷邏輯與計算原則

### 2.1 基本給藥規則

#### 腎功能分級與給藥劑量
- 正常腎功能：早晚各服用 2N+1R，共 10 劑次
- 中度腎功能不全：早晚各服用 1N+1R，共 10 劑次
- 重度腎功能不全/血液透析：僅早上服用，第 1 劑 2N+1R，後 4 劑 1N+1R，共 5 劑次

### 2.2 處理建議邏輯

#### 時間判定
- 8 小時內：可進行補救措施
- 超過 8 小時：視為未服用，下一劑依原時程

#### 漏服處理
1. Ritonavir 漏服（8 小時內）
   - 需重新服用完整劑量
   - 原先服用的 Nirmatrelvir 視為無效
   - 藥局需補發 Nirmatrelvir

2. 僅 Nirmatrelvir 漏服（8 小時內）
   - 僅需補吃漏服的 Nirmatrelvir 數量
   - 藥局需補發漏服的 Nirmatrelvir

3. 超過 8 小時的漏服
   - 該劑次視為未服用
   - 下一劑依原時程
   - 需回收未服用的藥品

#### 多服處理
1. 完整劑量多服（N 和 R 都是理論值的兩倍）
   - 跳過下一劑
   - 不需補發任何藥品

2. 部分多服
   - 多服 Ritonavir：
     - 藥局無多餘 Ritonavir 可補發
     - 建議在最後幾劑各少服用 1 顆 Ritonavir
     - 若剩餘劑次不足，需諮詢醫師
   - 僅多服 Nirmatrelvir：
     - 需補發多服的 Nirmatrelvir 數量

### 2.3 藥局補發提示邏輯

#### 補發條件
1. 漏服 Ritonavir 且 ≤ 8 小時
   - 補發 Nirmatrelvir
   - Ritonavir 由病人現場補吃

2. 部分多服 Nirmatrelvir
   - 補發多服數量

3. 完整多服
   - 不需補發

4. 其他狀況
   - 不需補發

### 2.4 護理餘藥提示邏輯

#### 回收條件
1. 漏服超過 8 小時
2. 需要跳過本劑
3. 有未服用的藥品

#### 回收內容
- 漏服的 Nirmatrelvir 數量
- 漏服的 Ritonavir 數量

## 3. 特殊情境範例

### 3.1 漏服情境
```
情境：正常腎功能病人，第 3 劑漏服 Ritonavir，發現時已過 6 小時
處理：
- 需重新服用完整劑量（2N+1R）
- 藥局需補發 2 顆 Nirmatrelvir
- Ritonavir 由病人現場補吃
```

### 3.2 多服情境
```
情境：中度腎功能不全病人，第 2 劑多服 1 顆 Ritonavir
處理：
- 建議最後 1 劑少服用 1 顆 Ritonavir
- 不需補發任何藥品
```

### 3.3 超過補救時間
```
情境：重度腎功能不全病人，第 1 劑完全漏服，發現時已過 10 小時
處理：
- 此劑視為未服用
- 下一劑依原時程
- 需回收 2 顆 Nirmatrelvir 和 1 顆 Ritonavir
```

## 4. 使用方法

1. 選擇腎功能狀況
   - 正常
   - 中度不全
   - 重度不全/血液透析

2. 輸入給藥資訊
   - 給藥錯誤的劑次
   - 距離給藥錯誤的時間（小時）

3. 輸入實際服藥量
   - 實際吃 Nirmatrelvir 錠數
   - 實際吃 Ritonavir 錠數

4. 查看處理建議
   - 視覺化顯示理論與實際服用量
   - 狀態指示器顯示異常類型
   - 時間指示器顯示補救時間
   - 立即補吃提示（如適用）
   - 剩餘療程安排

5. 查看藥局補發提示
   - 顯示需要補發的藥品數量
   - 顯示補發原因

6. 查看護理餘藥提示
   - 顯示需要回收的藥品數量
   - 顯示回收原因

注意事項：
- 所有時間計算以小時為單位
- 補救時間限制為 8 小時
- 多服 Ritonavir 時，若剩餘劑次不足，需諮詢醫師
- 完整多服時，下一劑需跳過
- 超過補救時間的漏服，下一劑依原時程
